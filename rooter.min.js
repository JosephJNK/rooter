(function(){var e,t,n,r=[].slice;e={listeners:[],listen:function(e){return n.hash.listeners.push(e)},trigger:function(e){var t,r;return e==null&&(e=n.hash.value()),e===""&&(e="/"),(r=(t=n.hash).pendingTeardown)==null&&(t.pendingTeardown=function(e){return e()}),n.hash.pendingTeardown(function(){var t,r,i,s;n.hash.pendingTeardown=function(e){return e()},s=n.hash.listeners;for(r=0,i=s.length;r<i;r++)t=s[r],t(e)})},value:function(e){return e&&(window.location.hash=e),window.location.hash.replace("#","")}},t={listeners:[],listen:function(e){return n.hash.listeners.push(e)},trigger:function(e){var t,r,i,s;e==null&&(e=n.hash.value()),e===""&&(e="/"),s=n.hash.listeners;for(r=0,i=s.length;r<i;r++)t=s[r],t(e)},value:function(e){return e&&(n.hash.lastHash=e,window.location.hash=e),window.location.hash.replace("#","")},lastHash:null,check:function(){var e;e=n.hash.value(),e!==n.hash.lastHash&&(n.hash.lastHash=e,n.hash.trigger(e)),setTimeout(n.hash.check,100)}},n={init:function(){return n.hash.pendingTeardown=function(e){return e()},n.hash.listen(n.test),n.hash.check?n.hash.check():n.hash.trigger()},routes:{},route:function(e,t,r){var i;i="^"+e+"$",i=i.replace(/([?=,\/])/g,"\\$1").replace(/:([\w\d]+)/g,"([^/]*)").replace(/(\$)$/g,"(?:\\?(.*))?$"),n.routes[e]={name:e,paramNames:e.match(/:([\w\d]+)/g),pattern:RegExp(i),setup:t,teardown:r?r:function(e){return e()},beforeFilters:[]}},runBeforeFilters:function(e,t,n){var r,i,s;return t==null&&(t={}),r=t,s=function(e){var t;return e.length===0?n(null,r):(t=e.shift(),t(r,function(t,i){return i==null&&(i=r),r=i,t!=null?n(t):s(e)}))},i=e.beforeFilters.slice(0),s(i)},test:function(t){var i,s,o,u,a,f,l,c,h,p,d,v,m,g;o=function(){var e,r,i,s;s=n.routes;for(i in s){e=s[i];if(r=e.pattern.exec(t))return[e,r]}return[null,null]},m=o(),s=m[0],f=m[1];if(!s)return;h={};if(s.paramNames){i=f.slice(1),g=s.paramNames;for(u=p=0,v=g.length;p<v;u=++p)l=g[u],h[l.substring(1)]=i[u]}return t.indexOf(!0)&&(a=2>f.length?(d=0,[]):r.call(f,0,d=f.length-1),c=f[d++]),n.runBeforeFilters(s,h,function(t,n){if(!t)return e.pendingTeardown=s.teardown,s.setup(n,c)})},addBeforeFilter:function(e,t){if(!n.routes[e])return;return n.routes[e].beforeFilters.push(t)}},typeof window.onhashchange!="undefined"?(n.hash=e,window.onhashchange=function(){return n.hash.trigger(n.hash.value())}):(n.hash=t,setTimeout(n.hash.check,100)),window.rooter=n}).call(this);